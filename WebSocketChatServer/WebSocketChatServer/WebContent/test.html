<!DOCTYPE html>
<html>
<head>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<title>Demo websocket</title>
</head>
<body>
	<h2>Demo WebSocket Chat Room</h2>
	<input id="textMessage" type="text" />
	<input onclick="sendMessage()" value="Send Message" type="button" />
	<br />
	<br />

	<textarea id="textAreaMessage" rows="10" cols="50"></textarea>

	<script type="text/javascript">
		var cookie = window.location.hash.substring(1);
		
		var websocket = new WebSocket(
				"ws://localhost:8080/WebSocketChatServer/chatRoomServer");
		websocket.onopen = function(message) {
			processOpen(message);
		};
		websocket.onmessage = function(message) {
			processMessage(message);
		};
		websocket.onclose = function(message) {
			processClose(message);
		};
		websocket.onerror = function(message) {
			processError(message);
		};

		function processOpen(message) {
			textAreaMessage.value += "Server connect... \n";
		}
		function processMessage(message) {
			console.log(message);
			//var respone = JSON.parse(message.data);
			textAreaMessage.value += "aaaa" + " \n";
			textAreaMessage.value += message.data + " \n";
			console.log(respone);
		}
		function processClose(message) {
			textAreaMessage.value += "Server Disconnect... \n";
		}
		function processError(message) {
			textAreaMessage.value += "Error... " + message + " \n";
		}

		function sendMessage() {
			if (typeof websocket != 'undefined'
					&& websocket.readyState == WebSocket.OPEN) {
				var message = $('#textMessage').val();
				var context = $('#textMessage').val();
				var message = {
					'toUser' : '2',
					'token' : cookie,
					'context' : context
				}
				console.log(message);
				websocket.send(JSON.stringify(message));
				textMessage.value = "";
			}
		}
	</script>
</body>
</html>